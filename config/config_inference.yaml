ID: geometrical_th03m_ #GNNeval_AICS02_resnext101
COMMENT: nodereid = embed reid  repetido dos veces
MODE: geometrical_association #GNN, REID, GNN_eval, eval_RANK, REID_th

#FOR GNN EVAL
ROUNDING: True
CUTTING: True
DISJOINT: True
PRETRAINED_GNN_MODEL: /home/elg/Repositories/GNN-Cross-Camera-Association/results/train_terr_not_attacing_fc6_edgeupdate2021-04-24 21:12:44/files/train_terr_not_attacing_fc6_edgeupdate_best.pth.tar

#  /home/elg/Repositories/GNN-Cross-Camera-Association/results/GNN_vehicles_AIC_resnext101_SGD0001_BNcls_SEP_LOSSES_POS_WEIGHT_decay25_2021-09-23 15:58:38/files/GNN_vehicles_AIC_resnext101_SGD0001_BNcls_SEP_LOSSES_POS_WEIGHT_decay25__latest.pth.tar

#  /home/elg/Repositories/GNN-Cross-Camera-Association/results/train_terr_not_attacing_fc6_edgeupdate2021-04-24 21:12:44/files/train_terr_not_attacing_fc6_edgeupdate_best.pth.tar
#  /home/elg/Repositories/GNN-Cross-Camera-Association/results/GNN_trainPETSyTerrace_resnet_app_dist_distx_disty_erase0.252021-07-09 10:42:28/files/GNN_trainPETSyTerrace_resnet_app_dist_distx_disty_erase0.25_best.pth.tar
#  /home/elg/Repositories/GNN-Cross-Camera-Association/results/GNN_trainLAByTerrace_resnet_app_dist_distx_disty_erase0.252021-07-08 15:48:49/files/GNN_trainLAByTerrace_resnet_app_dist_distx_disty_erase0.25_best.pth.tar
#  /home/elg/Repositories/GNN-Cross-Camera-Association/results/GNN_trainTERR_bdnetMarket_xtractor_distxy_distx_disty2021-05-19 18:24:32/files/GNN_trainTERR_bdnetExtractor_distxy_distx_disty_best.pth.tar

#  /home/elg/Repositories/GNN-cross-camera-association/results/GNN_trainTERR_osnet_mscd_app_dist_distx_disty2021-05-26 22:20:54/files/GNN_trainTERR_osnet_mscd_app_dist_distx_disty_best.pth.tar
#  /home/elg/Repositories/GNN-cross-camera-association/results/GNN_trainTERR_osnetMarket_app_dist_distx_disty2021-05-25 11:29:58/files/GNN_trainTERR_osnetMarket_app_dist_distx_disty_best.pth.tar
#  /home/elg/Repositories/GNN-cross-camera-association/results/GNN_trainTERR_bdnetCUHK_Extractor_distxy_distx_disty2021-05-20 00:26:22/files/GNN_trainTERR_bdnetCUHK_Extractor_distxy_distx_disty_best.pth.tar
#  /home/elg/Repositories/GNN-cross-camera-association/results/GNN_trainTERR_bdnetExtractor_distxy_distx_disty2021-05-19 18:24:32/files/GNN_trainTERR_bdnetExtractor_distxy_distx_disty_best.pth.tar
#/home/elg/Repositories/GNN-cross-camera-association/results/GNN_trainTERR_bdnetMarket_xtractor_distxy_distx_disty2021-05-19 18:24:32/files/GNN_trainTERR_bdnetExtractor_distxy_distx_disty_best.pth.tar

#  /home/elg/Repositories/GNN-Cross-Camera-Association/results/train_terr_not_attacing_fc6_edgeupdate2021-04-24 21:12:44/files/train_terr_not_attacing_fc6_edgeupdate_best.pth.tar


#FOR eval_RANK

RANK: 2

DATASET_TRAIN:
    IMAUG: True
    RESIZE:
      resnet50: [128, 64]
      bdnet_market: [384, 128]
      bdnet_cuhk: [384, 128]
      osnet_market: [256, 128]
      osnet_ms_c_d: [256, 128]
      resnext101_cars: [320, 320]
    MEAN: [0.485, 0.456, 0.406]
    STD: [0.229, 0.224, 0.225]

CONV_TO_M: # dist/CONV_TO_M to covert to meters
  PETS2009_S2_L1_5_8: 26.56
  EPFL-Laboratory: 44.23
  EPFL-Terrace: 50.83
  CAMPUS_Garden1: 85.23
  AIC20-S01: 0.00001
  AIC20-S02: 0.00001

#FOR GNN

DATASET_VAL:
    NAME: EPFL-Laboratory #AIC20-S02
    ROOT: /home/elg/Datasets/
    N_CLASSES:
    CROP:
    FRAME_SAMPLING:
    MEAN: [0.485, 0.456, 0.406]
    STD: [0.229, 0.224, 0.225]
    ZERO_PADDING: False


TRAINING:
    BATCH_SIZE:
        VAL: 1

    ONLY_APPEARANCE: False
    ONLY_DIST: False

CNN_MODEL:
    arch: resnet50 #resnet50 , bdnet_market, bdnet_cuhk, osnet_market, osnet_ms_c_d,resnext101_cars
    model_weights_path:
        resnet50: ./trained_models/reid/resnet50_market_cuhk_duke.tar-232
        bdnet_market: ./trained_models/top-dropblock/de00143e-market-model.pth.tar-400
        bdnet_cuhk: ./trained_models/top-dropblock/fbdaf3bb-cuhk-det-model.pth.tar-400
        osnet_market: ./trained_models/osnet/osnet_x1_0_market_256x128_amsgrad_ep150_stp60_lr0.0015_b64_fb10_softmax_labelsmooth_flip.pth
        osnet_ms_c_d:  ./trained_models/osnet/osnet_ms_d_c.pth.tar
        resnext101_cars: ./trained_models/vehicle-reid/resnext_101_multihead.pth
    L2norm: True


DATALOADER:
    NUM_WORKERS: 8
    PIN_MEMORY: True


GRAPH_NET_PARAMS:
  node_agg_fn: 'sum'
  num_enc_steps: 4  # before 4 Number of message passing steps
  num_class_steps: 3  # before 3Number of message passing steps during feature vectors are classified (after Message Passing)
  reattach_initial_nodes: False  # elg. Original: False Determines whether initially encoded node feats are used during node updates
  reattach_initial_edges: False  #  elg. Original: TrueDetermines whether initially encoded edge feats are used during node updates

  encoder_feats_dict:
    edges:
      edge_in_dim: 4 # elg: 2 if only appearance
      edge_fc_dims: [ ] #elg before [6]
      edge_out_dim: 6 # elg: original = 16 ours 1 if not encoding

    nodes:
      resnet50:
        #EDGES FEATURES ENCODER: in my case not encoding with just 1
  #      edge_in_dim: 4 # elg: 2 if only appearance
  #      edge_fc_dims: [] #elg before [6]
  #      edge_out_dim: 6 # elg: original = 16 ours 1 if not encoding

        #NODE FEATURES ENCODER
        node_in_dim: 2048
        #node_fc_dims: [512, 128]
        node_fc_dims: [128]
        node_out_dim: 32
        dropout_p: 0
        use_batchnorm: False

      bdnet_market:

        #NODE FEATURES ENCODER
        node_in_dim: 512
        #node_fc_dims: [512, 128]
        node_fc_dims: [128]
        node_out_dim: 32
        dropout_p: 0
        use_batchnorm: False
      bdnet_cuhk:

        #NODE FEATURES ENCODER
        node_in_dim: 512
        #node_fc_dims: [512, 128]
        node_fc_dims: [ 128 ]
        node_out_dim: 32
        dropout_p: 0
        use_batchnorm: False
      osnet_ms_c_d:

        #NODE FEATURES ENCODER
        node_in_dim: 512
        #node_fc_dims: [512, 128]
        node_fc_dims: [128]
        node_out_dim: 32
        dropout_p: 0
        use_batchnorm: True #False
      osnet_market:

        #NODE FEATURES ENCODER
        node_in_dim: 512
        #node_fc_dims: [512, 128]
        node_fc_dims: [ 128 ]
        node_out_dim: 32
        dropout_p: 0
        use_batchnorm: False
      resnext101_cars:
        #NODE FEATURES ENCODER
        node_in_dim: 2048
        #node_fc_dims: [512, 128]
        node_fc_dims: [ 128 ]
        node_out_dim: 32
        dropout_p: 0
        use_batchnorm: False


  # MPN EDGE UPDATE
  edge_model_feats_dict:
    fc_dims: [6] #  before 66,6elg: orig [80,16]In size is 4 * encoded nodes + 2 * encoded edges
    dropout_p: 0
    use_batchnorm: False

 # MPN NODE UPDATE

  node_model_feats_dict:
    fc_dims: [32]  # elg: orig [56,32] In size is 2 * encoded nodes + 1 * encoded edges
    dropout_p: 0
    use_batchnorm: False

  classifier_feats_dict:
    edge_in_dim: 6 #orig 16
    edge_fc_dims: [4] # orig
    edge_out_dim: 1
    dropout_p: 0
    use_batchnorm: False


    # for geometrical association
NORM_TO_M: True